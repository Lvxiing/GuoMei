(function(e,t){"use strict";if(typeof module==="object"&&typeof module.exports==="object"){module.exports=e.document?t(e,true):function(e){if(!e.document){throw new Error("Geetest requires a window with a document")}return t(e)}}else{t(e)}})(typeof window!=="undefined"?window:this,function(e,t){"use strict";if(typeof e==="undefined"){throw new Error("Geetest requires browser environment")}var n=e.document;var r=e.Math;var o=n.getElementsByTagName("head")[0];function i(e){this._obj=e}i.prototype={_each:function(e){var t=this._obj;for(var n in t){if(t.hasOwnProperty(n)){e(n,t[n])}}return this}};function a(e){var t=this;new i(e)._each(function(e,n){t[e]=n})}a.prototype={api_server:"api.geetest.com",protocol:"http://",type_path:"/gettype.php",fallback_config:{slide:{static_servers:["static.geetest.com","dn-staticdown.qbox.me"],type:"slide",slide:"/static/js/geetest.0.0.0.js"},fullpage:{static_servers:["static.geetest.com","dn-staticdown.qbox.me"],type:"fullpage",fullpage:"/static/js/fullpage.0.0.0.js"}},_get_fallback_config:function(){var e=this;if(c(e.type)){return e.fallback_config[e.type]}else if(e.new_captcha){return e.fallback_config.fullpage}else{return e.fallback_config.slide}},_extend:function(e){var t=this;new i(e)._each(function(e,n){t[e]=n})}};var f=function(e){return typeof e==="number"};var c=function(e){return typeof e==="string"};var u=function(e){return typeof e==="boolean"};var s=function(e){return typeof e==="object"&&e!==null};var l=function(e){return typeof e==="function"};var p={};var d={};var v=function(){return parseInt(r.random()*1e4)+(new Date).valueOf()};var g=function(e,t){var r=n.createElement("script");r.charset="UTF-8";r.async=true;r.onerror=function(){t(true)};var i=false;r.onload=r.onreadystatechange=function(){if(!i&&(!r.readyState||"loaded"===r.readyState||"complete"===r.readyState)){i=true;setTimeout(function(){t(false)},0)}};r.src=e;o.appendChild(r)};var h=function(e){return e.replace(/^https?:\/\/|\/$/g,"")};var _=function(e){e=e.replace(/\/+/g,"/");if(e.indexOf("/")!==0){e="/"+e}return e};var y=function(e){if(!e){return""}var t="?";new i(e)._each(function(e,n){if(c(n)||f(n)||u(n)){t=t+encodeURIComponent(e)+"="+encodeURIComponent(n)+"&"}});if(t==="?"){t=""}return t.replace(/&$/,"")};var w=function(e,t,n,r){t=h(t);var o=_(n)+y(r);if(t){o=e+t+o}return o};var m=function(e,t,n,r,o){var i=function(a){var f=w(e,t[a],n,r);g(f,function(e){if(e){if(a>=t.length-1){o(true)}else{i(a+1)}}else{o(false)}})};i(0)};var b=function(t,n,r,o){if(s(r.getLib)){r._extend(r.getLib);o(r);return}if(r.offline){o(r._get_fallback_config());return}var i="geetest_"+v();e[i]=function(t){if(t.status==="success"){o(t.data)}else if(!t.status){o(t)}else{o(r._get_fallback_config())}e[i]=undefined;try{delete e[i]}catch(n){}};m(r.protocol,t,n,{gt:r.gt,callback:i},function(e){if(e){o(r._get_fallback_config())}})};var k=function(e,t){var n={networkError:"网络错误"};if(typeof t.onError==="function"){t.onError(n[e])}else{throw new Error(n[e])}};var E=function(){return!!e.Geetest};if(E()){d.slide="loaded"}var j=function(t,n){var r=new a(t);if(t.https){r.protocol="https://"}else if(!t.protocol){r.protocol=e.location.protocol+"//"}b([r.api_server||r.apiserver],r.type_path,r,function(t){var o=t.type;var i=function(){r._extend(t);n(new e.Geetest(r))};p[o]=p[o]||[];var a=d[o]||"init";if(a==="init"){d[o]="loading";p[o].push(i);m(r.protocol,t.static_servers||t.domains,t[o]||t.path,null,function(e){if(e){d[o]="fail";k("networkError",r)}else{d[o]="loaded";var t=p[o];for(var n=0,i=t.length;n<i;n=n+1){var a=t[n];if(l(a)){a()}}p[o]=[]}})}else if(a==="loaded"){i()}else if(a==="fail"){k("networkError",r)}else if(a==="loading"){p[o].push(i)}})};e.initGeetest=j;return j});(function(e){function n(e){var n=[],t=[1e3*60*60*24,1e3*60*60,1e3*60,1e3,1];for(i=0;i<t.length;i++){n[i]=Math.floor(e/t[i]);e=e%t[i]}this.format=function(e){var t={"\\$d+":n[0],"\\$h+":n[1],"\\$m+":n[2],"\\$s+":n[3],"\\$S+":n[4]};for(var l in t){if(new RegExp("("+l+")").test(e)){e=e.replace(RegExp.$1,RegExp.$1.length==1?t[l]:("00"+t[l]).substr((""+t[l]).length>2?2:(""+t[l]).length))}}return e};this.getD=function(){return n}}e.gTimer=function(t){var l={ct:null,et:null,gap:1e3,aEven:null,iEven:null,lEven:null,Tindex:null};e.extend(l,t);if(l.ct==null||l.et==null||l.aEven==null)return;if(l.iEven)l.iEven.apply(l);var i=setInterval(function(){e.extend(l,{dt:new n(l.et-l.ct)});if(l.ct>=l.et){l.ct=l.et;clearInterval(i);l.dt=new n(l.et-l.ct);if(l.lEven)l.lEven.apply(l)}l.aEven.apply(l);l.ct=l.ct+l.gap},l.gap);return i}})(jQuery);(function(t){var a={pre:"上一页",next:"下一页",nav:function(t,a){var s="";if(a<=1||t>a){s=this.pager(1,1)}else{s+=t==1?this.showPre(0):this.showPre(1,t);if(a>6){var e=1;if(t>=5&&t<=a){s+=t==1?this.numStatusHTML(0,1):this.numStatusHTML(1,1)}else{for(var n=1;n<4;n++){s+=t==n?this.numStatusHTML(0,n):this.numStatusHTML(1,n)}}s+=t>=5?"<span class='placeholder'></span>":"";e=t-2;if(e>=3&&e<a-2)s+=t==e?this.numStatusHTML(0,e):this.numStatusHTML(1,e);e=t-1;if(e>3&&e<a-2)s+=t==e?this.numStatusHTML(0,e):this.numStatusHTML(1,e);e=t;if(e>3&&e<a-2)s+=t==e?this.numStatusHTML(0,e):this.numStatusHTML(1,e);e=t+1;if(e>3&&e<a-2)s+=t==e?this.numStatusHTML(0,e):this.numStatusHTML(1,e);e=t+2;if(e>3&&e<a-2)s+=t==e?this.numStatusHTML(0,e):this.numStatusHTML(1,e);s+=t<=a-4?"<span class='placeholder'></span>":"";if(t<=a-4){s+=t==a?this.numStatusHTML(0,a):this.numStatusHTML(1,a)}else{for(var n=a-2;n<=a;n++){s+=t==n?this.numStatusHTML(0,n):this.numStatusHTML(1,n)}}}else{for(var n=1;n<=a;n++){s+=t==n?this.numStatusHTML(0,n):this.numStatusHTML(1,n)}}s+=t==a?this.showNext(0):this.showNext(1,t)}return s},pager:function(t,a){var s="";if(a<=1){this.p=t;this.pn=a;s=this.showPre(0)+this.numStatusHTML(0,t)+this.showNext(0)}return s},go:function(t,a){var s=this.nav(t,a)+this.btnHTML(t,a);return s},numStatusHTML:function(t,a){return t==0?"<span class='cur'>"+a+"</span>":"<a href='javascript:void(0);' onclick='javascript:doPageNumSearch("+a+");return false;'>"+a+"</a>"},showPre:function(t,a){var s="<a class='prev disable' href='javascript:void(0);'>&nbsp;"+this.pre+"<s class='icon-prev'></s><i></i></a>";var e="<a class='prev' href='javascript:void(0);' onclick='javascript:doPageNumSearch("+(a-1)+");return false;'>&nbsp;"+this.pre+"<s class='icon-prev'></s><i></i></a>";return t==0?s:e},showNext:function(t,a){var s="<a class='next disable' href='javascript:void(0);'>"+this.next+"<s class='icon-next'></s><i></i></a>";var e="<a class='next' href='javascript:void(0);' onclick='javascript:doPageNumSearch("+(a+1)+");return false;'>"+this.next+"<s class='icon-next'></s><i></i></a>";return t==0?s:e},btnHTML:function(t,a){var s="<label for='pagenum' class='txt-wrap'>到<input type='text' id='pNum' class='txt' bNum='"+a+"' value='"+t+"'>页</label>"+"<a href='javascript:void(0)' zdx='nBtn' class='btn'>确定</a>";return s}};t.fn.extend({gPager:function(t){this.ucPager(t)},ucPager:function(s){var e=t.extend({pageClass:"pager",currentPage:1,totalPage:0,pageSize:15,clickCallback:function(){}},s);return this.each(function(){var s=t(this);if(!s.hasClass(e.pageClass)){s.addClass(e.pageClass)}var n=function(){e.clickCallback(e.currentPage)};s.html(a.go(e.currentPage,e.totalPage));window.doPageNumSearch=function(t){e.currentPage=t.toString();n()};window.doNextPageNum=function(t){if(e.currentPage==e.totalPage){e.currentPage--}else{e.currentPage++}doPageNumSearch(e.currentPage)};var i=t("#pNum",s);i.on("keyup",function(){var a=t(this).val(),s=/^\d+$/gi,e=/\d+/gi;if(!s.test(a)){t(this).val(a.match(e)?a.match(e)[0]:"")}});t(".btn",s).bind("click",function(){var a=t.trim(i.val());if(a<1){i.val(1);e.currentPage=1+""}else if(a>e.totalPage){i.val(e.totalPage);e.currentPage=e.totalPage.toString()}else{i.val(a);e.currentPage=a}n()})})}})})(jQuery);(function(a){var t="";var e="//ecs"+cookieDomain+"/voucher/fair";var n={ajaxListCompleted:true,quanCondition:{type:"99",cat:"0",sort:"0",page:"1",groupId:"ticket"},quanClass:{red:"cmred_bg",mei:"cmm_bg",shop:"cmshop_bg",licai:"cmlc_bg",blue:"cmblue_bg",huafei:"cmhf_bg",gray:"cmgray_bg",gouwu:"cmgw_bg",beauty:"hq_beauty"},quanTypeName:{red:"红券",shop:"店铺券",blue:"蓝券",gouwu:"购物券",beauty:"美券"},init:function(){var t=this;a(".cMarket .cM_navOne a").siblings().removeClass("active");a(".cMarket .cM_navOne a").eq(0).addClass("active");a(".cMarket .cM_Type a.sort").siblings(".sort").removeClass("active");a(".cMarket .cM_Type a.sort").eq(0).addClass("active");a(".cMarket .cM_Type a.type").siblings(".type").removeClass("active");a(".cMarket .cM_Type a.type").eq(0).addClass("active");t.loadList();t.bindEvent()},bindEvent:function(){var t=this;a(".cMarket .cM_navOne a").click(function(){t.quanCondition.page=1;t.quanCondition.cat=a(this).attr("data-value");a(".cMarket .cM_Type a.type").each(function(){if(t.quanCondition.cat!="0"){var e=a(this).attr("data-value");if(e=="shop"||e=="gouwu"){a(this).hide()}}else if(t.quanCondition.cat=="0"){a(this).show()}});a(this).siblings().removeClass("active");a(this).addClass("active");t.quanCondition.sort="0";a(".cMarket .cM_Type a.sort").removeClass("active").eq(0).addClass("active");t.quanCondition.type="99";a(".cMarket .cM_Type a.type").removeClass("active").eq(0).addClass("active");t.loadList()});a(".cMarket .cM_Type a.sort").click(function(){t.quanCondition.page=1;t.quanCondition.sort=a(this).attr("data-value");a(this).siblings(".sort").removeClass("active");a(this).addClass("active");t.loadList()});a(".cMarket .cM_Type a.type").click(function(){t.quanCondition.page=1;var e=a(this).attr("data-value");if(e=="shop"){e="0"}else if(e=="gouwu"){e="2"}t.quanCondition.type=e;a(this).siblings(".type").removeClass("active");a(this).addClass("active");t.loadList()})},loadNoData:function(){a(".cM_coupon").html('<span class="nodata">发券的同学太懒啦，没有给这个品类配些券！！！</span>')},loadList:function(){var t=this;if(!t.ajaxListCompleted)return;t.ajaxListCompleted=false;a(".cM_coupon").html("");a(".cM_couponWrap .product-waiting").show();a.ajax({url:e,type:"get",data:t.quanCondition,dataType:"jsonp",success:function(e){a(".cM_couponWrap .product-waiting").hide();if(e==null||e==""){t.loadNoData();t.ajaxListCompleted=true;return}if(typeof e=="string"){e=JSON.parse(e)}if(e.contentSize<=0){t.loadNoData();t.ajaxListCompleted=true;return}a.each(e.content,function(e,n){var o=t.elementHtml(n);a(".cM_couponWrap ul.cM_coupon").append(o)});t.splitLoadQuanState();var n={};n.currentPage=e.pageNum;n.totalPage=e.totalPage;t.loadPager(n);t.ajaxListCompleted=true}})},splitFaceValue:function(a){var t=[];if(a.indexOf(".")==-1){t.push(a+".");t.push("00");t.push(t[0]+t[1]);return t}t=a.split(".");t[0]=t[0]+".";if(t[1].length<2){t[1]=t[1]+"0"}t[2]=t[0]+t[1];return t},getDateString:function(a){var t=new Date(a);var e=t.getFullYear()+"."+(t.getMonth()+1)+"."+t.getDate();return e},elementHtml:function(a){var t=this;var e=t.splitFaceValue(a.couponAmount+"");a.price_Integer=e[0];a.price_decimal=e[1];a.price_whole=e[2];var n="";a.rule="";if(a.fullAmount&&a.fullAmount>0){var o=t.splitFaceValue(a.fullAmount+"");a.rule="满"+o[2]+"可用"}else{a.rule=a.couponDesc;n='title="'+a.couponDesc+'"'}var i=/^[0-9]+.?[0-9]*$/;a.busType="";if(i.test(a.couponType)){if(a.couponType=="3"){a.busType="3"}if(a.couponType=="0"||a.couponType=="3"){a.couponType="shop"}else if(a.couponType=="2"){a.couponType="gouwu"}}var c="";var u="";a.shopName?u="<br/>"+a.shopName:"";if(a.caseId){c='data-quanid="'+a.caseId+'"'}else if(a.activeId){c='data-activeId="'+a.activeId+'" data-couponcode="'+a.code+'" data-costdeptId="'+a.costdeptId+'"'}if(!a.couponLabelDetail){a.couponLabelDetail=t.quanTypeName[a.couponType]}var r="<li "+c+' data-coupontype="'+a.couponType+'" data-busType="'+a.busType+'">                            <div class="cMc_style '+t.quanClass[a.couponType]+'">                                <div class="cMPrice">                                    <em>¥</em>                                    <strong>'+a.price_Integer+"</strong>                                    <span>"+a.price_decimal+'</span>                                </div>                                <p class="cMInfo" '+n+">                                    <em>【"+a.couponLabelDetail+"】</em>"+a.rule+'                                </p>                                <p class="cMTime">'+t.getDateString(a.startDate)+" - "+t.getDateString(a.endDate)+'</p>                            </div>                            <div class="cM_text">                               <p style="padding:10px 20px 0px 18px;height:50px;white-space:inherit;text-overflow:inherit" title="'+a.couponDesc+u+'">使用范围：'+a.couponDesc+u+'</p>                               <a href="javascript:;">立即领券</a>                            </div>                        </li>';return r},splitLoadQuanState:function(){var t=this;var e=a(".cM_couponWrap ul.cM_coupon");var n=e.find("[data-quanid]");if(n.length>0){var o=n.map(function(){return a(this).attr("data-quanid")}).get().join(",");t.loadQuanState(o)}var i=e.find("[data-couponcode]");if(i.length>0){var c=i.map(function(){return a(this).attr("data-couponcode")}).get().join(",");t.loadLianYingQuanState(c)}},loadLianYingQuanState:function(e){var n=this;var o=a(".cM_couponWrap ul.cM_coupon");if(e==undefined||e==""||e.length<=0){return}var i="//hd"+cookieDomain+t+"/promotion/coupons/getPopCouponsRemain.do?";a.ajax({url:i,type:"get",data:{codes:e},dataType:"jsonp",success:function(t){if(t==null||t==""){return}if(typeof t=="string"){t=JSON.parse(t)}if(t.state!="success"){return}a.each(t.coupons,function(t,e){var o=e.code;var o=e.code;var i=a(".cM_couponWrap ul.cM_coupon");var c=i.find("[data-couponcode ="+o+"]");var u=e.caseState;if(u==0){c.append('<div class="broughtout"></div>');c.find(".cMc_style").addClass("cmgray_bg");return}var r=e.batchRemainNum;var s=e.userRemainNum;var d=e.batchTotalNum;var p=e.userTotalNum;c.find(".cM_text a").off("click");if(r>0&&s<=0){c.find(".cM_text a").html("立即使用");if(c.attr("data-coupontype")=="shop"){var l="//mall"+cookieDomain+"/"+c.attr("data-costdeptid")+"/";var f=c.attr("data-busType");if(f&&f=="3"){l="//quan"+cookieDomain+"/?"+c.attr("data-couponcode")+"&ly=1"}c.find(".cM_text a").attr("target","_blank").attr("href",l)}else{var v=a(".cMarket .cM_navTwo").find("a[data-value='gouwu']").attr("data-usehref");c.find(".cM_text a").attr("target","_blank").attr("href",v)}c.append('<div class="hasGone"></div>')}else if(r>0){if(typeof window.validCodeBox.fetchLianYingCoupon=="function"){c.find(".cM_text a").on("click",function(){window.gomeClicki("send","event","优惠券点击 ",o+"-领券中心",c.attr("data-coupontype"));window.validCodeBox.fetchLianYingCoupon(o,c.attr("data-activeId"),function(a){n.loadLianYingQuanState(a)})})}}else if(r<=0){c.append('<div class="broughtout"></div>');c.find(".cMc_style").addClass("cmgray_bg")}})}})},loadQuanState:function(e){var n=this;var o=a(".cM_couponWrap ul.cM_coupon");if(e==undefined||e==""||e.length<=0){return}var i="//hd"+cookieDomain+t+"/promotion/coupons/getCouponsResource.do?";a.ajax({url:i,type:"get",data:{promIdStr:e},dataType:"jsonp",success:function(t){if(t==null||t==""){return}if(typeof t=="string"){t=JSON.parse(t)}if(!t.state){return}a.each(t.coupons,function(e,n){a.each(t.extdata,function(a,t){if(t.promid!=n.promId){return}n.rule=t.rule;n.count=t.count;n.budget=t.budget});var i=0;if(n.userId){i=n.count-n.userRemainCount}var c=o.find('[data-quanid="'+n.promId+'"]');c.attr("data-couponrule",n.rule);c.find(".cM_text a").off("click");if(n.userId&&i>0&&n.userRemainCount<=0){c.find(".cM_text a").html("立即使用");c.find(".cM_text a").attr("href","//quan"+cookieDomain+"/?"+n.rule).attr("target","_blank");c.append('<div class="hasGone"></div>')}else if(n.remainBudget>0){if(typeof window.validCodeBox.fetchCoupon=="function"){c.find(".cM_text a").on("click",function(){window.gomeClicki("send","event","优惠券点��� ",n.promId+"-领券中心",c.attr("data-coupontype"));window.validCodeBox.fetchCoupon(n.promId,function(a){if(a=="0"){c.append('<div class="hasGone"></div>');c.find(".cM_text a").html("立即使用");c.find(".cM_text a").off("click");c.find(".cM_text a").attr("href","//quan"+cookieDomain+"/?"+n.rule).attr("target","_blank")}})})}}else if(n.remainBudget<=0){c.append('<div class="broughtout"></div>');c.find(".cMc_style").addClass("cmgray_bg")}})}})},loadPager:function(t){var e=this;a(".pager").gPager({currentPage:t.currentPage,totalPage:t.totalPage,pageSize:25,clickCallback:function(a){e.quanCondition.page=a;e.loadList()}})},cmSelected:function(){var t=this;a(".cM_shop").on("mouseenter",function(){a(this).addClass("on")}).on("mouseleave",function(){a(this).removeClass("on")});a(".cM_shop_dropdown input").on("focus",function(){this.placeholder="";a(this).siblings("p").addClass("on")}).on("blur",function(){this.placeholder="按店铺名称搜索";a(this).siblings("p").removeClass("on")})}};setTimeout(function(){if(!window.refresh){n.init()}},1e3);a(function(){n.init()})})(jQuery);(function(){window.refresh=false;document.onreadystatechange=function(){window.refresh=true}})();$(function(){var t="";var e="//ecs"+cookieDomain+"/voucher/rushBuy";var o={ajaxListCompleted:true,timeHourIndex:0,timeHour:["00:00","08:00","14:00","20:00","22:00"],quanCondition:{tab:"1",groupId:"ticket"},quanClass:{red:"hq_red",shop:"hq_green",blue:"hq_blue",gray:"loot_all_img",beauty:"hq_beauty",market:"hq_blue"},quanTypeName:{red:"红券",shop:"店铺券",blue:"蓝券",gouwu:"购物券",beauty:"美券",market:"营销券"},processBarTotal:220,init:function(){var t=this;t.countDown();t.loadListConfig();t.tabClick()},tabClick:function(){var t=this;$(".tab_time").click(function(){if(t.timeHourIndex>$(this).index()||t.quanCondition.tab==$(this).index()+1){return}$(this).siblings(".tab_time").removeClass("tab_time_selected").removeClass("tab_time_clicked");if(t.timeHourIndex==$(this).index()){$(this).addClass("tab_time_selected")}if(t.timeHourIndex<$(this).index()){$(this).addClass("tab_time_clicked")}t.quanCondition.tab=$(this).index()+1;t.loadList();console.log("好券秒抢显示"+t.timeHour[t.quanCondition.tab-1]+"券")})},loadNoData:function(){$(".coupon_wbox_img ul").html('<span class="nodata">今日没有比较划算的券啦，请明日再来看看吧</span>')},loadListConfig:function(){var t=this;if(!t.ajaxListCompleted)return;t.ajaxListCompleted=false;$(".coupon_wbox_img ul").html("");$(".coupon_wbox_img .product-waiting").show();try{var e=window.goodCoupons.length}catch(o){window.goodCoupons=[]}if(!window.goodCoupons||window.goodCoupons.length<=0){t.ajaxListCompleted=true;$(".coupon_wbox_img .product-waiting").hide();t.loadList()}var n="";$.each(window.goodCoupons,function(t,e){n+=e.caseId+","});t.loadQuanStateConfig(n,function(e){$.each(window.goodCoupons,function(o,n){if($(".coupon_wbox_img ul li").length>=6){return}if(e[n.caseId+"_remain"]>0){n.fullAmount=e[n.caseId+"_famount"];var i=t.elementHtml(n);$(".coupon_wbox_img ul").append(i)}});t.ajaxListCompleted=true;$(".coupon_wbox_img .product-waiting").hide();if($(".coupon_wbox_img ul li").length<6){t.loadList()}else{t.loadQuanState()}})},loadList:function(){var t=this;t.ajaxListCompleted=false;$.ajax({url:e,type:"get",data:t.quanCondition,dataType:"jsonp",success:function(e){$(".coupon_wbox_img .product-waiting").hide();if(e==null||e==""){t.loadNoData();t.ajaxListCompleted=true;return}if(typeof e=="string"){e=JSON.parse(e)}if(e.contentSize>0){$.each(e.content,function(e,o){if($(".coupon_wbox_img ul li").length>=6){return}var n=t.elementHtml(o);$(".coupon_wbox_img ul").append(n)})}if($(".coupon_wbox_img ul li").length<=0){t.loadNoData()}else{t.loadQuanState()}t.ajaxListCompleted=true}})},splitFaceValue:function(t){var e=[];if(t.indexOf(".")==-1){e.push(t+".");e.push("00");e.push(e[0]+e[1]);return e}e=t.split(".");e[0]=e[0]+".";if(e[1].length<2){e[1]=e[1]+"0"}e[2]=e[0]+e[1];return e},elementHtml:function(t){var e=this;var o=e.splitFaceValue(t.couponAmount+"");t.price_Integer=o[0];t.price_decimal=o[1];t.price_whole=o[2];var n="";t.rule="";if(t.fullAmount&&t.fullAmount>0){var i=e.splitFaceValue(t.fullAmount+"");t.rule="消费满"+i[2]+"元可用"}else{t.rule=t.promDescr;n='title="'+t.promDescr+'"'}if(!t.url||t.url==" "){t.url="//gfs10.gomein.net.cn/T1unCsBjVT1RCvBVdK.png"}if(!t.couponLabelDetail){t.couponLabelDetail=e.quanTypeName[t.couponType]}var a='<li class="coupon_wbox_bg '+e.quanClass[t.couponType]+'" data-quanid="'+t.caseId+'" data-coupontype="'+t.couponType+'">							<div class="coupon_wbox_red_s_img">								<img src="'+t.url+'" style="width:140px; height:140px; margin-top: 0px; display: block;" />				            </div>			                <div class="coupon_wbox_s_content">			                  	<div class="coupon_wbox_price">￥<span>'+t.price_Integer+"</span>"+t.price_decimal+'</div>			                  	<div class="coupon_wbox_txt">			                    	<p class="coupon_wbox_t_txt t_txt_color" '+n+'><span class="hq_name">【'+t.couponLabelDetail+"】</span>"+t.rule+'</p>			                    	<p class="b_txt_color" title="'+t.couponDesc+'">'+t.couponDesc+'</p>			                  	</div>			                  	<div class="coupon_wbox_content_line">				                    <div class="line">				                       	<b class="red_line" style="width:0px;"></b>				                    </div>			                    	<div class="red_line_r">剩余0%</div>			                  	</div>			                </div>			                <a class="coupon_bg_img">			                  	<i class="red_coupon_bg_txt">立即领券</i>			                </a>			            </li>';return a},loadQuanStateConfig:function(e,o){var n=this;if(e==undefined||e==""||e.length<=0){return}var i="//hd"+cookieDomain+t+"/promotion/coupons/getCaseState.do?";$.ajax({url:i,type:"get",data:{promIdStr:e},dataType:"jsonp",success:function(t){if(t==null||t==""){return}if(typeof t=="string"){t=JSON.parse(t)}if(!t.state){return}var e={};$.each(t.coupons,function(t,o){e[o.promId+"_remain"]=o.remainBudget;e[o.promId+"_famount"]=o.fullAmount});o(e)}})},loadQuanState:function(){var e=this;var o=$(".coupon_wbox_img ul");var n=o.find("[data-quanid]").map(function(){return $(this).attr("data-quanid")}).get().join(",");if(n==undefined||n==""||n.length<=0){return}var i="//hd"+cookieDomain+t+"/promotion/coupons/getCouponsResource.do?";$.ajax({url:i,type:"get",data:{promIdStr:n},dataType:"jsonp",success:function(t){if(t==null||t==""){return}if(typeof t=="string"){t=JSON.parse(t)}if(!t.state){return}$.each(t.coupons,function(n,i){$.each(t.extdata,function(t,e){if(e.promid!=i.promId){return}i.rule=e.rule;i.count=e.count;i.budget=e.budget});var a=0;if(i.userId){a=i.count-i.userRemainCount}var u=o.find('[data-quanid="'+i.promId+'"]');u.attr("data-couponrule",i.rule);if(i.userId&&a>0&&i.userRemainCount<=0){u.find(".coupon_bg_img i").html("立即使用");u.find(".coupon_bg_img").attr("href","//quan"+cookieDomain+"/?"+i.rule).attr("target","_blank")}else if(i.remainBudget>0){if(typeof window.validCodeBox.fetchCoupon=="function"){u.find(".coupon_bg_img").click(function(){window.gomeClicki("send","event","优惠券点击 ",i.promId+"-领券中心",u.attr("data-coupontype"));window.validCodeBox.fetchCoupon(i.promId,function(t){if(t=="0"){u.find(".coupon_bg_img i").html("立即使用");u.find(".coupon_bg_img").off("click");u.find(".coupon_bg_img").attr("href","//quan"+cookieDomain+"/?"+i.rule).attr("target","_blank")}})})}}else if(i.remainBudget<=0){u.append('<div class="loot_all_r_img"></div>');u.addClass("loot_all_img")}var r=(i.budget-i.remainBudget)/i.budget*e.processBarTotal;r=Math.floor(r);var l=i.remainBudget/i.budget*100;l=Math.ceil(l*100)/100;u.find(".red_line").width(r);if(l>100){l=100}else if(l<0){l=0}u.find(".red_line_r").html("剩余"+l+"%")})}})},modifyTabText:function(){var t=this;$(".coupon_wbox_tab .tab_time").slice(0,t.timeHourIndex).find(".rob_tab_selected_text_begin").html("已结束");$(".coupon_wbox_tab .tab_time").slice(t.timeHourIndex,t.timeHourIndex+1).find(".rob_tab_selected_text_begin").html("正在秒抢券");$(".coupon_wbox_tab .tab_time").slice(t.timeHourIndex+1,$(".coupon_wbox_tab .tab_time").length).find(".rob_tab_selected_text_begin").html("即将开始")},getCurrentStartTime:function(){var t=this;var e=t.timeHour.reverse();var o=new Date;var n=o.getFullYear()+"/"+(o.getMonth()+1)+"/"+o.getDate();for(var i in e){var a=n+" "+e[i];var u=new Date(a).getTime();if(o.getTime()>u){return u}}},getCurrentEndTime:function(){var t=this;var e=t.timeHour;var o=new Date;var n=o.getFullYear()+"/"+(o.getMonth()+1)+"/"+o.getDate();for(var i in e){var a=n+" "+e[i];var u=new Date(a).getTime();if(o.getTime()<u){t.quanCondition.tab=i;t.timeHourIndex=i-1;t.modifyTabText();$(".coupon_wbox_tab .tab_time").removeClass("tab_time_selected").removeClass("tab_time_clicked");$(".coupon_wbox_tab .tab_time").eq(i-1).addClass("tab_time_selected");return u}}$(".coupon_wbox_tab .tab_time").eq(e.length-1).addClass("tab_time_selected");var r=new Date;r.setDate(r.getDate()+1);var l=r.getFullYear()+"/"+(r.getMonth()+1)+"/"+r.getDate();return new Date(l).getTime()},countDown:function(){var t=this;$.gTimer({ct:(new Date).getTime(),et:t.getCurrentEndTime(),aEven:function(t,e,o,n){var i=this.et-this.ct-288e5;var a=new Date(i);var u=a.getHours();if(u>=0&&u<=9){u="0"+u}var r=a.getMinutes();if(r>=0&&r<=9){r="0"+r}var l=a.getSeconds();if(l>=0&&l<=9){l="0"+l}$(".coupon_wbox_tab .tab_time_selected").find(".hour").html(u);$(".coupon_wbox_tab .tab_time_selected").find(".minutes").html(r);$(".coupon_wbox_tab .tab_time_selected").find(".seconds").html(l)},lEven:function(){$(".coupon_wbox_tab .tab_time").find(".hour").html("00");$(".coupon_wbox_tab .tab_time").find(".minutes").html("00");$(".coupon_wbox_tab .tab_time").find(".seconds").html("00");t.countDown()}})}};setTimeout(function(){if(!window.refresh){o.init()}},1e3);o.init();window.refresh=false;document.onreadystatechange=function(){window.refresh=true}});(function(t){var a={pre:"上一页",next:"下一页",nav:function(t,a){var s="";if(a<=1||t>a){s=this.pager(1,1)}else{s+=t==1?this.showPre(0):this.showPre(1,t);if(a>6){var e=1;if(t>=5&&t<=a){s+=t==1?this.numStatusHTML(0,1):this.numStatusHTML(1,1)}else{for(var n=1;n<4;n++){s+=t==n?this.numStatusHTML(0,n):this.numStatusHTML(1,n)}}s+=t>=5?"<span class='placeholder'></span>":"";e=t-2;if(e>=3&&e<a-2)s+=t==e?this.numStatusHTML(0,e):this.numStatusHTML(1,e);e=t-1;if(e>3&&e<a-2)s+=t==e?this.numStatusHTML(0,e):this.numStatusHTML(1,e);e=t;if(e>3&&e<a-2)s+=t==e?this.numStatusHTML(0,e):this.numStatusHTML(1,e);e=t+1;if(e>3&&e<a-2)s+=t==e?this.numStatusHTML(0,e):this.numStatusHTML(1,e);e=t+2;if(e>3&&e<a-2)s+=t==e?this.numStatusHTML(0,e):this.numStatusHTML(1,e);s+=t<=a-4?"<span class='placeholder'></span>":"";if(t<=a-4){s+=t==a?this.numStatusHTML(0,a):this.numStatusHTML(1,a)}else{for(var n=a-2;n<=a;n++){s+=t==n?this.numStatusHTML(0,n):this.numStatusHTML(1,n)}}}else{for(var n=1;n<=a;n++){s+=t==n?this.numStatusHTML(0,n):this.numStatusHTML(1,n)}}s+=t==a?this.showNext(0):this.showNext(1,t)}return s},pager:function(t,a){var s="";if(a<=1){this.p=t;this.pn=a;s=this.showPre(0)+this.numStatusHTML(0,t)+this.showNext(0)}return s},go:function(t,a){var s=this.nav(t,a)+this.btnHTML(t,a);return s},numStatusHTML:function(t,a){return t==0?"<span class='cur'>"+a+"</span>":"<a href='javascript:void(0);' onclick='javascript:doPageNumSearch("+a+");return false;'>"+a+"</a>"},showPre:function(t,a){var s="<a class='prev disable' href='javascript:void(0);'>&nbsp;"+this.pre+"<s class='icon-prev'></s><i></i></a>";var e="<a class='prev' href='javascript:void(0);' onclick='javascript:doPageNumSearch("+(a-1)+");return false;'>&nbsp;"+this.pre+"<s class='icon-prev'></s><i></i></a>";return t==0?s:e},showNext:function(t,a){var s="<a class='next disable' href='javascript:void(0);'>"+this.next+"<s class='icon-next'></s><i></i></a>";var e="<a class='next' href='javascript:void(0);' onclick='javascript:doPageNumSearch("+(a+1)+");return false;'>"+this.next+"<s class='icon-next'></s><i></i></a>";return t==0?s:e},btnHTML:function(t,a){var s="<label for='pagenum' class='txt-wrap'>到<input type='text' id='pNum' class='txt' bNum='"+a+"' value='"+t+"'>页</label>"+"<a href='javascript:void(0)' zdx='nBtn' class='btn'>确定</a>";return s}};t.fn.extend({gPager:function(t){this.ucPager(t)},ucPager:function(s){var e=t.extend({pageClass:"pager",currentPage:1,totalPage:0,pageSize:15,clickCallback:function(){}},s);return this.each(function(){var s=t(this);if(!s.hasClass(e.pageClass)){s.addClass(e.pageClass)}var n=function(){e.clickCallback(e.currentPage)};s.html(a.go(e.currentPage,e.totalPage));window.doPageNumSearch=function(t){e.currentPage=t.toString();n()};window.doNextPageNum=function(t){if(e.currentPage==e.totalPage){e.currentPage--}else{e.currentPage++}doPageNumSearch(e.currentPage)};var i=t("#pNum",s);i.on("keyup",function(){var a=t(this).val(),s=/^\d+$/gi,e=/\d+/gi;if(!s.test(a)){t(this).val(a.match(e)?a.match(e)[0]:"")}});t(".btn",s).bind("click",function(){var a=t.trim(i.val());if(a<1){i.val(1);e.currentPage=1+""}else if(a>e.totalPage){i.val(e.totalPage);e.currentPage=e.totalPage.toString()}else{i.val(a);e.currentPage=a}n()})})}})})(jQuery);(function(){var e={timer:null,caseId:"",hdPort:"",container:"popup",curUuid:"",uuid:function(){var e=[];var t="0123456789abcdef";for(var i=0;i<36;i++){e[i]=t.substr(Math.floor(Math.random()*16),1)}e[14]="4";e[19]=t.substr(e[19]&3|8,1);e[8]=e[13]=e[18]=e[23]="-";var o=e.join("");return o},init:function(){var e=this;e.curUuid=e.uuid();e.bindEvent()},bindEvent:function(){var e=this;$("body").on("click","."+e.container+" .btn_no,."+e.container+" .close",function(){e.hideCodeBox()});$("body").on("click","."+e.container+" .ver_img,."+e.container+" .ver_change",function(){e.refreshImgCode()});$("body").on("click","."+e.container+" .tips a.jhsj",function(){window.location.href="//myhome"+cookieDomain+"/member/accountSecurity?atc=atc"});$("body").on("click","."+e.container+" .continue_btn",function(){var t=$("."+e.container+" .ver_info").val();if(!t){return}e.fetchlingquan1()})},refreshImgCode:function(){var e=this;var t="//imgcode"+cookieDomain+"/getimage.no?type=gome_sale_activities_coupons&capCd="+e.curUuid+"&r="+Math.random();$("."+e.container+" .ver_info").val("");$("."+e.container+" .ver_img").attr("src",t)},containerHtml:function(){var e='<div class="popup">							<div class="popup-body">							</div>							<a class="icon close" title="关闭"></a>						</div>';return e},codeHtml:function(){var e='<div class="tips">							<p>请输入验证码</p>						</div>						<div class="ver_info_box" id="captchaLoad">							<input type="text" id="captcha" name="verinfo" class="ver_info" placeholder="验证码">							<img src="" alt="" class="ver_img" title="点击刷新">							<a href="javascript:;" class="ver_change">换一张</a>						</div>						<p class="error_tips" id="captchaTip"></p>						<a href="javascript:;" class="continue_btn" title="继续">继续</a>';return e},successHtml:function(e){if(!e){e="//myhome"+cookieDomain+"/member/gomeMyCoupon"}var t='<div class="tips">							<div class="icon icon_right"></div>							<p>领券成功！感谢您的参与，祝您购物愉快~</p>						</div>						<div class="btn_box">							<a href="'+e+'" target="_blank" class="btn_ok">立即使用</a>							<a href="javascript:;" class="btn_no" title="取消">取消</a>						</div>						<p class="close_later"><span>5</span> 秒后自动关闭</p>';return t},warnHtml:function(){var e='<div class="tips">							<div class="icon icon_right"></div>							<p></p>						</div>						<div class="btn_box">						</div>';return e},showCodeBox:function(e,t){var i=this;i.showOverlay();if($("."+i.container).length<=0){$("body").append(i.containerHtml());$("."+i.container).show()}else{$("."+i.container).find(".popup-body").html("")}switch(e){case"code":$("."+i.container).find(".popup-body").html(i.codeHtml());$("."+i.container).addClass("verification_box");i.refreshImgCode();break;case"success":$("."+i.container).find(".popup-body").html(i.successHtml(t));$("."+i.container).removeClass("verification_box");i.delayClose();break;case"warn":$("."+i.container).find(".popup-body").html(i.warnHtml());$("."+i.container).removeClass("verification_box");break}},showOverlay:function(){var e=$.browser.msie,t=e&&$.browser.version<7;if($("#Overlay").length<=0){if(!t){$("body").append("<div id='Overlay' style='background:#000;cursor: pointer;display: block;filter:alpha(opacity=60);opacity: 0.6;height:100%;width:100%; position: fixed; left: 0;top: 0;z-index:999'></div>")}else{$("html").css({height:"100%"});$("body").css({height:"100%"});$("body").append("<div class='overlay' id='Overlay'><iframe  frameborder=0 id='frame1' style='filter:alpha(opacity=10);opacity: 0.6;height:100%;width:100%;'></iframe></div>")}}$("#Overlay").show()},hideCodeBox:function(){var e=this;clearInterval(e.timer);if($("#Overlay").length>0){$("#Overlay").hide()}if($("."+e.container).length>0){$("."+e.container).remove()}},delayClose:function(){var e=this;var t=5;$("."+e.container).find(".close_later span").html(t);clearInterval(e.timer);e.timer=setInterval(function(){t--;$("."+e.container).find(".close_later span").html(t);if(t<=0){clearInterval(e.timer);e.hideCodeBox()}},1e3)},getQueryString:function(e){var t=new RegExp("(^|&)"+e+"=([^&]*)(&|$)","i");var i=window.location.search.substr(1).match(t);if(i!=null)return unescape(i[2]);return null},fetchLianYingCoupon:function(e,t,i){var o=this;g.login(function(){var a=$("#captcha").val();if(!a){a=""}$.ajax({url:"//hd"+cookieDomain+o.hdPort+"/promotion/shopCoupons/getShopCoupons.do",type:"get",dataType:"jsonp",jsonpName:"getShopCoupons",data:"couponId="+e+"&activeId="+t+"&time="+(new Date).getTime(),error:function(e,t,i){alert("系统繁忙，请稍后再试。")},success:function(e){if(e.result=="ANONYMOUS"){$("."+o.container+" .tips").html("<div class='icon icon_error'></div><p>对不起，请重新登录</p>");return}if(e.result=="ADDCOUPON"){var t=$('[data-couponcode="'+e.couponId+'"]');o.showCodeBox("warn");var a=e.addStatus;if(a=="1"){var n=t.attr("data-coupontype");var r=t.attr("data-busType");var c=$(".cMarket .cM_navTwo").find("a[data-value='gouwu']").attr("data-usehref");if(n=="shop"){c="//mall"+cookieDomain+"/"+t.attr("data-costdeptid")+"/"}if(r&&r=="3"){c="//quan"+cookieDomain+"/?"+e.couponId+"&ly=1"}o.showCodeBox("success",c);i(e.couponId);window.gomeClicki("send","event","优惠券领取成功 ",e.couponId+"-"+t.attr("data-coupondesc"),t.attr("data-coupontype"));window.GomeSa&&GomeSa.track("Voucher",{coupon_id:e.couponId});return}else if(a=="2"||a=="5"||a=="7"){$("."+o.container+" .tips").html("<div class='icon icon_error'></div><p>对不起，活动已结束</p>");return}else if(a=="3"){$("."+o.container+" .tips").html("<div class='icon icon_error'></div><p>对不起，您领取的优惠券已发送完，谢谢参与</p>");return}else if(a=="4"){$("."+o.container+" .tips").html("<div class='icon icon_error'></div><p>对不起，优惠券领取失败，请稍后再试</p>");return}else if(a=="6"){$("."+o.container+" .tips").html("<div class='icon icon_error'></div><p>对不起，您已不能再领取此优惠券</p>");return}}}})})},fetchlingquan1:function(e){var t=this;var i=$("#captcha").val();var o="";if(!i){i=""}if(e&&e.geetest_challenge){o="&geetest_challenge="+e.geetest_challenge+"&geetest_validate="+e.geetest_validate+"&geetest_seccode="+e.geetest_seccode}$.ajax({url:"//hd"+cookieDomain+t.hdPort+"/promotion/coupons/getCouponsForCenter.do",type:"get",dataType:"jsonp",contentType:"text/html;charset=UTF-8",data:"promId="+t.caseId+"&captchaCode="+i+"&uuid="+t.curUuid+"&cps="+t.getQueryString("param")+"&activityDescription="+encodeURI(document.title)+o,error:function(e,t,i){alert("系统繁忙，请稍后再试。")},success:function(e){if(e.state=="success"){var i=$('[data-quanid="'+e.promId+'"]');var o="//quan"+cookieDomain+"/?"+i.attr("data-couponrule");t.showCodeBox("success",o);window.gomeClicki("send","event","优惠券领取成功 ",e.promId+"-"+i.attr("data-coupondesc"),i.attr("data-coupontype"));window.GomeSa&&GomeSa.track("Voucher",{coupon_id:e.promId})}else{t.showCodeBox("warn");if(e.state=="no_login"){$("."+t.container+" .tips").html("<div class='icon icon_error'></div><p>对不起，请重新登录</p>")}else if(e.state=="no_promid"||e.state=="end"){$("."+t.container+" .tips").html("<div class='icon icon_error'></div><p>对不起，活动已结束</p>")}else if(e.state=="user_exception"){$("."+t.container+" .tips").html("<div class='icon icon_error'></div><p>用户存在异常</p>")}else if(e.state=="risk_black"||e.state=="prom_u_black"||e.state=="prom_address_black"){$("."+t.container+" .tips").html("<div class='icon icon_error'></div><p>太可惜了没有领取成功，居然与它擦肩而过</p>")}else if(e.state=="failed"){$("."+t.container+" .tips").html("<div class='icon icon_error'></div><p>对不起，优惠券领取失败，请稍后再试</p>")}else if(e.state=="no_start"){$("."+t.container+" .tips").html("<div class='icon icon_error'></div><p>活动尚未开始</p>")}else if(e.state=="no_mobile"){$("."+t.container+" .tips").html('<div class=\'icon icon_error\'></div><p>您的手机未激活，暂时不能领取优惠券,<a target="_blank" href="//myhome'+cookieDomain+'/member/accountSecurity?atc=atc" class="jhsj">点此激活</a></p>')}else if(e.state=="user_no_count"){$("."+t.container+" .tips").html("<div class='icon icon_error'></div><p>对不起，您已不能再领取此优惠券</p>")}else if(e.state=="Integral_problem"){$("."+t.container+" .tips").html("<div class='icon icon_error'></div><p>您的积分不足</p>")}else if(e.state=="coupon_empty"){$("."+t.container+" .tips").html("<div class='icon icon_error'></div><p>对不起，您领取的优惠券已发送完，谢谢参与</p>")}else if(e.state=="prom_chapcha"){t.showCodeBox("code");$("."+t.container+" .error_tips").html("请输入验证码")}else if(e.state=="captcha_empty"){t.showCodeBox("code");$("."+t.container+" .error_tips").html("请输入验证码")}else if(e.state=="captcha_error"){t.showCodeBox("code");$("."+t.container+" .error_tips").html("验证码错误,请��入验证码")}else if(e.state=="captcha_outtime"){t.showCodeBox("code");$("."+t.container+" .error_tips").html("验证码过期,请输入验证码")}else if(e.state=="get_grade_exception"){$("."+t.container+" .tips").html("<div class='icon icon_error'></div><p>对不起，优惠券领取失败，请稍后再试</p>")}else if(e.state=="grade_limit"){$("."+t.container+" .tips").html("<div class='icon icon_error'></div><p>很抱歉，您的会员等级不能领取这张券哦~</p>")}else if(e.state=="grade_equals_g1"){$("."+t.container+" .tips").html("<div class='icon icon_error'></div><p>仅限G1会员领取哦~</p>")}else if(e.state=="data_error"){$("."+t.container+" .tips").html("<div class='icon icon_error'></div><p>对不起，优惠券领取失败，请稍后再试</p>")}else{if(!e.remark){e.remark="对不起，优惠券领取失败，请稍后再试"}$("."+t.container+" .tips").html("<div class='icon icon_error'></div><p>"+e.remark+"</p>")}}}})},fetchCoupon:function(e){var t=this;t.caseId=e;var i=function(e){e.onReady(function(){e.verify()}).onSuccess(function(){var i=e.getValidate();if(!i){}else{t.fetchlingquan1(i)}}).onError(function(){})};g.login(function(){$.ajax({url:"//hd"+cookieDomain+t.hdPort+"/promotion/geetest/startCaptcha.do?t="+(new Date).getTime(),type:"get",dataType:"jsonp",jsonpName:"lingquan"+(new Date).getTime(),success:function(e){if(!(e&&e.captcha&&e.captcha=="F")){initGeetest({gt:e.gt,challenge:e.challenge,offline:!e.success,new_captcha:e.new_captcha,timeout:"5000",product:"bind",width:"300px"},i)}else{t.fetchlingquan1()}}})})}};e.init();window.validCodeBox=e})();