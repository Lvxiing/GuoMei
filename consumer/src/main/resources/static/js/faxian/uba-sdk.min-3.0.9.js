/*
 * uba-sdk v1.3.5, bundle: 2017-06-06 13:55
 * (c) 2017 gomeBigData
 */
!function(){function __decorate(t,e,n,o){var i,r=arguments.length,a=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(r<3?i(a):r>3?i(e,n,a):i(e,n))||a);return r>3&&a&&Object.defineProperty(e,n,a),a}function permit(t){return function(e){e.enable=t}}function before(t){return function(e){e.load=t}}function getSubDomain(t,e){void 0===e&&(e=PLUS_REGEX);var n=t.match(e);return n&&n[1]}function init(){function t(){!bpOnce&&allowInitLog&&(BP.pvLog(),bpOnce=!0)}domReady(function(){readyTime=(new Date).valueOf(),setTimeout(function(){t()},3e3)}),addEvent(window,"load",function(){loadTime=(new Date).valueOf(),readyTime||(readyTime=loadTime),t()})}function Xget(t,e,n){this.headers={Accept:"*/*","Cache-Control":""},this.callback=n.callback,this.errHandler=n.errHandler||function(t){},this.url=t+"?"+jsonToQuery(e),this.options={_async:!0,timeout:3e4,attempts:2},this.attempts=0,this.aborted=!1,this.timeoutid=null}function setData(t){bps=t,bplength=t.length}function fetchData(){var t=PI.url(),e=dataUrl["dc-7"===tid?"pre":"pro"],n={pageUrl:t,platform:isMobile?"H5":"PC"};e&&new Xget(e,n,{callback:function(t){if("200"===t.code&&"0"===t.iserror){var e=void 0;(e=t.data)&&(e=e.result)&&setData(e)}}}).send()}function cleanIntcmp(t){return t.replace(INTCMP_REGEX,rcb)}function getIntcmp(t){var e=t.match(INTCMP_REGEX);return e&&e[2]}function calcTagNum(t,e){for(var n=0,o=!1,i=t.children,r=0,a=i.length;r<a;r++){var s=i[r];if("a"===s.tagName.toLowerCase()){if(s===e){o=!0;break}n++}else if(!s.hasAttribute(MOD_META)){var c=calcTagNum(s,e);if(n+=c.count,c.found)return{count:n,found:!0}}}return{count:n,found:o}}function storeCmpid(t,e,n){var o=t.match(CMPID_REGEX);return cmpid=o&&o[2],cmpid&&(0!==cmpid.indexOf(CMPID_FLAG)&&(cmpid=CMPID_FLAG+cmpid),setCookie("cmpid",cmpid,n,e,6e4)),cmpid}function getCmpid(){return cmpid||(cmpid=getCookie("cmpid"))}function load(){for(var t=[],e=0,n=[Suda$1,UBA$1,Intcmp$1,Cmpid$1];e<n.length;e++){var o=n[e];o.enable&&(o.load&&o.load(),t.push(o))}bindClickEvent(t)}function bindClickEvent(t){0!==t.length&&addEvent(doc,isMobile?"touchstart":"click",function(e){for(var n=e.srcElement||e.target,o=new Processor(t,new Store({target:n}));n&&n.parentNode;)o.update(n),o.exec("process"),n=n.parentNode;o.exec("post"),o.post()})}var win="undefined"!=typeof window?window:self,PAGE_ID="page_id",dataUrl={pre:"//point-pre.gomeplus.com/bomber-api/sdk/point",pro:"//point.gomeplus.com/bomber-api/sdk/point"},doc=document,scr=win.screen,nav=navigator,ua=nav.userAgent,prtl="https:"===win.location.protocol?"https://":"http://",host="beacon.gomeplus.com/",gifurl=prtl+host+"log?";window.BPConfig=window.BPConfig||{};var pageHost=window.location.host,PLUS_REGEX=/\.?(.+)\.gomeplus\.com/,GOME_REGEX=/^(.+\.)*gome\.com\.cn/,hostList=[{key:"dc-7",rule:/pre|dev|test|atg|uat/},{key:"dc-14",rule:/^(.+\.)*wap\.gomegj\.com/},{key:"dc-10",rule:/^(.+\.)*diy\.gome\.com\.cn/},{key:"dc-12",rule:/^(.+\.)*m\.gomehigo\.hk/},{key:"dc-2",rule:/^(.+\.)*(m\.gome\.com\.cn|m\.gomeplus\.com)/},{key:"dc-6",rule:/^(.+\.)*gomehigo\.hk/},{key:"dc-1",rule:GOME_REGEX},{key:"dc-13",rule:/^(.+\.)*gomegj\.com/},{key:"dc-16",rule:PLUS_REGEX}],tid=window.BPConfig.tid,isGomePlus=PLUS_REGEX.test(pageHost);if(null==tid){for(var _i=0,hostList_1=hostList;_i<hostList_1.length;_i++){var data=hostList_1[_i];if(data.rule.exec(pageHost)){tid=data.key;break}}window.BPConfig.tid=tid}for(var domainList=["gomegj.com","gome.com.cn","gomehigo.hk","gomeplus.com","atguat.com.cn"],mainhost,i=0,len=domainList.length;i<len;i++){var dm=domainList[i];if(pageHost.indexOf(dm)>-1){mainhost=dm;break}}var isGomeWebView=/gomeplus/i.test(ua),isPhantomJSUser=/PhantomJSUser/i.test(ua),allowBindClick=!isGomeWebView,allowInitLog=allowBindClick||!!tid,allowSendLog=!isPhantomJSUser&&allowInitLog,stringSplice=function(t,e,n,o){if(""===t)return"";o=""===o?"=":o,e+=o;var i=t.indexOf(e);if(i<0)return"";i+=e.length;var r=t.indexOf(n,i);return r<i&&(r=t.length),t.substring(i,r)},jsonToQuery=function(t){var e="";for(var n in t)t.hasOwnProperty(n)&&(e+=n+"="+t[n]+"&");return e.substr(0,e.length-1)},JSONParse=function(){return win.JSON?JSON.parse:function(t){return new Function("return"+t)()}}(),insertQuery=function(t,e){var n=jsonToQuery(e);if(!n)return!1;var o,i=t.match(/(.+?)(#.*)$/);return i?(o=i[1],i=i[2]):o=t,(o.indexOf("?")>-1?o+"&"+n:o+"?"+n)+(i||"")},getCookie=function(t){return undefined===t||""===t?"":stringSplice(doc.cookie,t,";","")},setCookie=function(t,e,n,o,i){if(void 0===i&&(i=864e5),null!=e){var r=t+"="+e+";path=/";if(n){var a=new Date,s=a.getTime();s+=i*n,a.setTime(s),r+=";expires="+a.toUTCString()}o&&(r+=";domain="+o),doc.cookie=r}},isMobile=function(){try{return doc.createEvent("TouchEvent"),!0}catch(t){return!1}}(),sendRequest=function(){var t=[];return function(e){if(allowSendLog){var n=new Image;t.push(n),n.src=e}}}(),collects=function(t,e){var n=[];for(var o in t)t.hasOwnProperty(o)&&n.push(o+":"+t[o]());return e+n.join("|")},getSource=function(){return"source="+encodeURIComponent(stringSplice(win.location.href,"source","&",""))},getWm=function(){return"wm="+(isMobile?"m":"www")},getRandom=function(){var t=new Date;return Math.ceil(1e12*Math.random())+"."+t.getTime()},querySelector=function(t){return(querySelector=document.querySelector?function(t){return document.querySelector(t)}:function(t){var e=document.documentElement.firstChild,n=document.createElement("STYLE");if(e)return e.appendChild(n),document.__qsResult=[],n.styleSheet.cssText=t+"{x:expression(document.__qsResult.push(this))}",window.scrollBy(0,0),e.removeChild(n),document.__qsResult[0]||null})(t)},isReady=!1,domReadyCbs=[],ready=function(){if(!isReady){isReady=!0;for(var t=0;t<domReadyCbs.length;t++)domReadyCbs[t]()}},domReady=function(t){if(domReadyCbs.push(t),"complete"===doc.readyState)setTimeout(ready,1);else if(doc.addEventListener)doc.addEventListener("DOMContentLoaded",ready,!1),win.addEventListener("load",ready,!1);else{doc.attachEvent("onreadystatechange",ready),win.attachEvent("onload",ready);var e=!1;try{e=null===window.frameElement&&document.documentElement}catch(n){}e&&e.doScroll&&function o(){if(!isReady){try{e.doScroll("left")}catch(n){return setTimeout(o,50)}ready()}}()}},addEvent=function(){return doc.attachEvent?function(t,e,n){t.attachEvent("on"+e,n)}:doc.addEventListener?function(t,e,n){t.addEventListener(e,n,!1)}:function(t,e,n){}}(),mixin=function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t},ref=doc.referrer.toLowerCase(),COOKIE_PHPSID="mx_wap_gomeplusid",COOKIE_PHPPCID="mx_pc_gomeplusid",COOKIE_NEW="isnew",COOKIE_SSID="ssid",COOKIE_LASTTIME="plasttime",CI={screen_size:function(){return scr.width+"x"+scr.height},color_depth:function(){return scr.colorDepth||""},app_code:function(){return nav.appCodeName||""},app_name:function(){return nav.appName.indexOf("Microsoft Internet Explorer")>-1?"MSIE":nav.appName},cpu:function(){return nav.cpuClass||nav.oscpu||""},platform:function(){return nav.platform||""},network:function(){var t="";if(t=nav.connection&&nav.connection.type?nav.connection.type:t)return t;try{doc.body.addBehavior("#default#clientCaps"),t=doc.body.connectionType}catch(e){t="-"}return t},language:function(){return nav.systemLanguage||nav.language||""},timezone:function(){return(new Date).getTimezoneOffset()/60||""},flash_ver:function(){var f="-",n=navigator,ii;if(n.plugins&&n.plugins.length){for(ii=0;ii<n.plugins.length;ii++)if(-1!==n.plugins[ii].name.indexOf("Shockwave Flash")){f=n.plugins[ii].description.split("Shockwave Flash ")[1];break}}else if(win.ActiveXObject)for(ii=10;ii>=2;ii--)try{var fl=eval("new ActiveXObject('ShockwaveFlash.ShockwaveFlash."+ii+"');");if(fl){f=ii+".0";break}}catch(e){}return f},ua:function(){return encodeURIComponent(ua)}},PI={pagename:function(){return encodeURIComponent(document.title||"-")},referrer:function(){var t=/^[^?&#]*.swf([?#])?/;return""!==ref&&!ref.match(t)||(ref=stringSplice(win.location.href,"ref","&","")),encodeURIComponent(ref)},is_homepage:function(){var t="";try{doc.body.addBehavior("#default#homePage"),t=doc.body.isHomePage(win.location.href)?"Y":"N"}catch(e){t="unkown"}return t},dom_count:function(){return doc.getElementsByTagName("*").length||""},iframe_count:function(){return doc.getElementsByTagName("iframe").length},url:function(){return encodeURIComponent(win.location.href.replace(/(intcmp|cmpid)=[^&]+&?/g,"").replace(/[?&]*(#.*)?$/,""))},tid:function(){return tid||""}},UI={phpsid:function(){return getCookie(COOKIE_PHPSID)||getCookie(COOKIE_PHPPCID)},ssid:function(){var t=getCookie(COOKIE_SSID);return""===t&&(t=getRandom(),setCookie(COOKIE_SSID,t,1825,mainhost)),t},is_new:function(){var t=getCookie(COOKIE_NEW);return""===t?(t=getRandom(),setCookie(COOKIE_NEW,t,7),1):0},uid:function(){return window.userId||""},shop_id:function(){return win.BPConfig.shop_id||""},produce_id:function(){return win.BPConfig.produce_id||""},group_id:function(){return win.groupId?win.groupId:""},topic_id:function(){return win.topicId?win.topicId:""},channel:function(){return win.BPConfig.channel||""}},SI={last_time:function(){var t=getCookie(COOKIE_LASTTIME);if(win.BPConfig.serverTime)t||(t=win.BPConfig.serverTime),setCookie(COOKIE_LASTTIME,win.BPConfig.serverTime,365);else{var e=Math.round((new Date).getTime()/1e3);t||(t=e),setCookie(COOKIE_LASTTIME,e,365)}return t},active_no:function(){return win.active_no?win.active_no:"-"},page_id:function(){return win[PAGE_ID]?win[PAGE_ID]:"-"},page_name:function(){return win._page_name_?win._page_name_:"-"}},startTime=win.BPConfig.startTime,headEndTime=win.BPConfig.headEndTime,loadTime,readyTime,P={sdate:function(){return win.BPConfig.serverTime?win.BPConfig.serverTime:"-"},load_time:function(){return startTime&&loadTime?loadTime-startTime:"-"},ready_time:function(){return startTime&&readyTime?readyTime-startTime:"-"},first_screen_time:function(){return headEndTime&&startTime?headEndTime-startTime:"-"},dict_v:function(){return"2017030301"}},BP={getPvData:function(){return[collects(CI,"CI="),collects(PI,"PI="),collects(UI,"UI="),collects(P,"P="),collects(SI,"SI=")].join("&")+"&"+getSource()},pvLog:function(){var t=gifurl+getWm()+"&"+this.getPvData();sendRequest(t)},getExt:function(){return[collects(PI,"PI="),collects(P,"P="),getWm(),collects(UI,"UI=")].join("&")},send:function(t){var e=jsonToQuery(t);if(e){var n=gifurl+this.getExt()+"&"+e;sendRequest(n)}}},bpOnce=!1,PROP_SUDA="sudaData",PROP_HREF="href",PROP_HREF_ADDIN="insertJson",PROP_CURRENT_NODE="target",PROP_A_NODE="atarget",SUDA_META="bp-data",MOD_META="modelid",BP_BLOCK="block",BP_POINT="point",Suda=function(){function t(){this.done=!1}return t.prototype.process=function(t,e,n){var o=e.assignSuda,i=n.getCurrentTarget,r=i(t);if(r.hasAttribute(SUDA_META)){var a=r.getAttribute(SUDA_META),s={};try{s=JSONParse(a)}catch(c){s.error="JSON parse error, please check "+SUDA_META}s.name||(s.name="-"),o(t,s),this.done=!0}},t}();Suda=__decorate([permit(allowBindClick&&isGomePlus)],Suda);var Suda$1=Suda,xdr,getXHR=win.XMLHttpRequest?function(){return new win.XMLHttpRequest}:function(){return new win.ActiveXObject("Microsoft.XMLHTTP")},xhr2=""===getXHR().responseType;Xget.prototype.abort=function(){this.aborted||(this.xhr&&4!=this.xhr.readyState&&this.xhr.abort(),this.aborted=!0)},Xget.prototype.handleResponse=function(t){if(void 0===t&&(t=this.xhr),clearTimeout(this.timeoutid),!this.aborted)try{if("json"==t.responseType){if("response"in t&&null===t.response)throw"The request response is empty";this.response=t.response}else this.response=JSONParse(t.responseText);if("status"in t&&!/^2|1223/.test(t.status))throw t.status+" ("+t.statusText+")";this.callback(this.response)}catch(e){this.handleError(e.message)}},Xget.prototype.handleTimeout=function(){this.aborted||(this.options.attempts&&++this.attempts==this.options.attempts?this.handleError("Timeout ("+this.url+")"):(this.xhr.abort(),this.send()))},Xget.prototype.handleError=function(t){this.aborted||(t="string"==typeof t?t:"Connection aborted",this.abort(),this.errHandler(t))},Xget.prototype.send=function(t){var e=this,n=void 0===t?{}:t,o=n.method,i=void 0===o?"get":o,r=n.url,a=void 0===r?this.url:r,s=n.options,c=void 0===s?this.options:s,u=n.headers,d=void 0===u?this.headers:u,p=getXHR();if(win.XDomainRequest&&(p=new win.XDomainRequest,xdr=!0),xdr?p.open(i,a):p.open(i,a,c._async),this.xhr=p,!xdr)for(var f in d)d[f]&&p.setRequestHeader(f,d[f]);xhr2||xdr?(p.onload=function(){e.handleResponse.apply(e)},p.onerror=function(){e.handleError.apply(e)},xdr&&(p.onprogress=function(){})):p.onreadystatechange=function(){4==p.readyState&&e.handleResponse.apply(e)},c._async?"timeout"in p?(p.timeout=c.timeout,p.ontimeout=function(){e.handleTimeout.apply(e)}):this.timeoutid=setTimeout(function(){e.handleTimeout.apply(e)},c.timeout):xdr&&(p.ontimeout=function(){}),xdr?setTimeout(function(){p.send(null)},0):p.send(null)};var bps,bplength=0,UBA=function(){function t(t,e,n){var o=n.getCurrentTarget,i=o(t);this.done=!1,this._filterd=[],this._blocks=[],this._points=[],this.ptfound=!1,this.blockfound=!1,this.ubaparam=[];for(var r=!1,a=0;a<bplength;a++){var s=bps[a],c=s.selector,u=void 0;try{u=querySelector(c),this._filterd.push(s)}catch(d){r=!0}u&&(s.type===BP_BLOCK?this._blocks.push({node:u,data:s}):this.ptfound||s.type!==BP_POINT||(i===u?(this.ptfound=!0,this.ubaparam.push(s)):this._points.push({node:u,data:s})))}r&&setData(bps)}return t.prototype.process=function(t,e,n){var o=n.getCurrentTarget,i=o(t),r=!1;if(!this.ptfound&&!this.blockfound)for(var a=this._points,s=0,c=a.length;s<c;s++)if(a[s].node===i){this.ubaparam.push(a[s].data),this.ptfound=!0,r=!0;break}if(!r){for(var u=void 0,d=this._blocks,s=0,c=d.length;s<c;s++)if(d[s].node===i){this.ubaparam.push(d[s].data),this.blockfound=!0,u=s;break}null!=u&&d.splice(u,1)}},t.prototype.post=function(t,e){var n=e.updateSuda,o=this.ubaparam;if(o.length){for(var i=o[0]._point_id,r="",a=0,s=o.length;a<s;a++)r+=o[a].pointParam+"|";r=r.slice(0,-1).replace(/=/g,":").replace(/&/g,"|"),n(t,"UBA",r),n(t,"UBAid",i)}},t}();UBA=__decorate([before(fetchData),permit(allowBindClick&&!GOME_REGEX.test(pageHost))],UBA);var UBA$1=UBA,INTCMP_REGEX=/([?&])intcmp=(.+?)(&(.+))?(#.*)?$/,rcb=function(t,e,n,o,i,r){return i?e+i+(r||""):r||""},Intcmp=function(){function t(){this.done=!1}return t.prototype.process=function(t,e,n){var o=n.getCurrentTarget,i=o(t);i.hasAttribute(MOD_META)?(this.modelid=i.getAttribute(MOD_META),this.modeltarget=i,this.done=!0):this.atarget||"a"!==i.tagName.toLowerCase()||-1!==i.href.indexOf("javascript")||(this.atarget=i)},t.prototype.post=function(t,e){var n=e.setATag,o=e.updateSuda,i=e.setHref,r=e.updateHrefJson,a=this.atarget;if(a){var s=a.href,c=void 0,u=win[PAGE_ID]||getSubDomain(pageHost)||"null";if(this.modelid){var d=calcTagNum(this.modeltarget,a).count;c=u+"-"+this.modelid+"-"+d,o(t,"intcmp",c)}else(c=getIntcmp(s))&&o(t,"intcmp",c);s=cleanIntcmp(s),c&&r(t,"intcmp",c),i(t,s),n(t,a)}},t}();Intcmp=__decorate([permit(allowBindClick&&isGomePlus)],Intcmp);var Intcmp$1=Intcmp,CMPID_REGEX=/([?&])cmpid=(.+?)(&(.+))?(#.*)?$/,CMPID_FLAG="plus_",cmpid,DOMAIN_REGEX=/^(https?:)?\/\//,Cmpid=function(){function t(){}return t.prototype.post=function(t,e,n){var o=e.updateHrefJson,i=n.getHref,r=i(t);if(r&&DOMAIN_REGEX.test(r)&&!PLUS_REGEX.test(r)){var a=getCmpid();a&&o(t,"cmpid",a)}},t}();Cmpid=__decorate([before(function(){return storeCmpid(win.location.href,mainhost,30)}),permit(allowBindClick&&isGomePlus)],Cmpid);var Cmpid$1=Cmpid,actions={updateSuda:function(t,e,n){var o=t.getState(PROP_SUDA)||{};return o[e]=n,t.commit({key:PROP_SUDA,data:o})},assignSuda:function(t,e){var n=t.getState(PROP_SUDA)||{};return t.commit({key:PROP_SUDA,data:mixin(n,e)})},setCurrentTarget:function(t,e){return t.commit({key:PROP_CURRENT_NODE,data:e})},setATag:function(t,e){return t.commit({key:PROP_A_NODE,data:e})},updateATagHref:function(t){var e=t.getState(PROP_HREF_ADDIN),n=t.getState(PROP_HREF);if(n&&e){var o=insertQuery(n,e),i=t.getState(PROP_A_NODE);i&&o&&(i.href=o)}},updateHrefJson:function(t,e,n){var o=t.getState(PROP_HREF_ADDIN)||{};return o[e]=n,t.commit({key:PROP_HREF_ADDIN,data:o})},setHref:function(t,e){return t.commit({key:PROP_HREF,data:e})}},getters={getSudaDate:function(t){return t.getState(PROP_SUDA)},getCurrentTarget:function(t){return t.getState(PROP_CURRENT_NODE)},getATag:function(t){return t.getState(PROP_A_NODE)},getHref:function(t){return t.getState(PROP_HREF)}},Processor=function(){function t(t,e){this.store=e;for(var n=this.length=t.length,o=[],i=[],r=0;r<n;r++){var a=new t[r](e,actions,getters);a.process&&o.push(a),a.post&&i.push(a)}this.controllers={process:o,post:i}}return t.prototype.exec=function(t){var e=this.controllers[t];if(e)for(var n=void 0,o=0;n=e[o];)n[t](this.store,actions,getters),n.done?e.splice(o,1):o++},t.prototype.update=function(t){actions.setCurrentTarget(this.store,t)},t.prototype.post=function(){var t=getters.getSudaDate(this.store);if(t){var e=getters.getHref(this.store);e&&(t=actions.updateSuda(this.store,"href",encodeURIComponent(e)),actions.updateATagHref(this.store)),BP.send(t)}},t}(),Store=function(){function t(t){this._state=t}return t.prototype.getState=function(t){return this._state[t]},t.prototype.commit=function(t){return this._state[t.key]=t.data,t.data},t}();win.BP=BP,init(),load()}();